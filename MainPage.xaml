<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:viewmodels="clr-namespace:Examen_Mvvm.ViewModels"
    xmlns:comps="clr-namespace:Examen_Mvvm.Comportamientos"
    x:Class="Examen_Mvvm.MainPage"
    x:DataType="viewmodels:MainViewModel"
    Title="Examen-Mvvm"
    Background="{StaticResource AppBackgroundBrush}">

 
    <ContentPage.BindingContext>
        <viewmodels:MainViewModel />
    </ContentPage.BindingContext>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="16">

            <Label Text="Calculo de descuento"
                   Style="{StaticResource TitleLabel}"
                   Margin="4,0,0,0" />


            <Border Style="{StaticResource CardBorder}" Padding="24">
                <Grid RowSpacing="16" ColumnSpacing="12">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="8"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Producto 1 -->
                    <VerticalStackLayout Grid.Row="0" Spacing="6">
                        <Label Text="Producto 1" Style="{StaticResource SectionLabel}" />
                        <Border Style="{StaticResource CardBorder}" StrokeThickness="1" Padding="12" Margin="0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="12"/>
                            </Border.StrokeShape>
                            <Entry
                                Style="{StaticResource CleanEntry}"
                                Keyboard="Numeric"
                                Placeholder="0.00"
                                Text="{Binding Product1}">
                                <Entry.Behaviors>
                                    <comps:ComportamientoEntradaNumerica />
                                </Entry.Behaviors>
                            </Entry>
                        </Border>
                    </VerticalStackLayout>

                    <!-- Producto 2 -->
                    <VerticalStackLayout Grid.Row="1" Spacing="6">
                        <Label Text="Producto 2" Style="{StaticResource SectionLabel}" />
                        <Border Style="{StaticResource CardBorder}" StrokeThickness="1" Padding="12" Margin="0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="12"/>
                            </Border.StrokeShape>
                            <Entry
                                Style="{StaticResource CleanEntry}"
                                Keyboard="Numeric"
                                Placeholder="0.00"
                                Text="{Binding Product2}">
                                <Entry.Behaviors>
                                    <comps:ComportamientoEntradaNumerica />
                                </Entry.Behaviors>
                            </Entry>
                        </Border>
                    </VerticalStackLayout>

                    <!-- Producto 3 -->
                    <VerticalStackLayout Grid.Row="2" Spacing="6">
                        <Label Text="Producto 3" Style="{StaticResource SectionLabel}" />
                        <Border Style="{StaticResource CardBorder}" StrokeThickness="1" Padding="12" Margin="0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="12"/>
                            </Border.StrokeShape>
                            <Entry
                                Style="{StaticResource CleanEntry}"
                                Keyboard="Numeric"
                                Placeholder="0.00"
                                Text="{Binding Product3}">
                                <Entry.Behaviors>
                                    <comps:ComportamientoEntradaNumerica />
                                </Entry.Behaviors>
                            </Entry>
                        </Border>
                    </VerticalStackLayout>

                    <!-- Separador -->
                    <BoxView Grid.Row="3" HeightRequest="1" Color="{StaticResource CardStroke}" />

                    <!-- Subtotal -->
                    <Grid Grid.Row="4" ColumnDefinitions="Auto,*" ColumnSpacing="8">
                        <Label Text="Subtotal" Style="{StaticResource SectionLabel}" />
                        <Label Grid.Column="1"
                               HorizontalTextAlignment="End"
                               Style="{StaticResource ValueLabel}"
                               Text="{Binding Subtotal, StringFormat='L{0:N2}'}" />
                    </Grid>

                    <!-- Descuento -->
                    <Grid Grid.Row="5" ColumnDefinitions="Auto,*" ColumnSpacing="8">
                        <Label Text="Descuento aplicado" Style="{StaticResource SectionLabel}" />
                        <Label Grid.Column="1"
                               HorizontalTextAlignment="End"
                               Style="{StaticResource ValueLabel}"
                               Text="{Binding Descuento, StringFormat='{0}%'}" />
                    </Grid>

                    <!-- Total -->
                    <Grid Grid.Row="6" ColumnDefinitions="Auto,*" ColumnSpacing="8">
                        <Label Text="Total a pagar" Style="{StaticResource SectionLabel}" />
                        <Label Grid.Column="1"
                               HorizontalTextAlignment="End"
                               Style="{StaticResource ValueLabel}"
                               Text="{Binding Total, StringFormat='L{0:N2}'}" />
                    </Grid>

                </Grid>
            </Border>

            <!-- BOTONES: fuera de la tarjeta para evitar cualquier recorte -->
            <HorizontalStackLayout Spacing="12" Margin="0,0,0,8">
                <Button Text="Calcular"
                        Style="{StaticResource PrimaryButton}"
                        Command="{Binding CalcularCommand}" />
                <Button Text="Limpiar"
                        Style="{StaticResource TonalButton}"
                        Command="{Binding LimpiarCommand}" />
            </HorizontalStackLayout>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
